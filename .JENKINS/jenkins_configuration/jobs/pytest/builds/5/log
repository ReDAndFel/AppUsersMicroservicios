Started by user [8mha:////4Nita3wYCRxduj1G2MT4V8huTc10nMoTGHqAHpi6MgtnAAAAmh+LCAAAAAAAAP9b85aBtbiIQTGjNKU4P08vOT+vOD8nVc83PyU1x6OyILUoJzMv2y+/JJUBAhiZGBgqihhk0NSjKDWzXb3RdlLBUSYGJk8GtpzUvPSSDB8G5tKinBIGIZ+sxLJE/ZzEvHT94JKizLx0a6BxUmjGOUNodHsLgAzhEgY+/dLi1CL9xKLk0ryUzHwAj/Qt9cMAAAA=[0msantiago arciniegas
[8mha:////4Osds3MoTJU0/5dfAT/h7sxdqWmT1cIdGgWSa9QGkum6AAAAoh+LCAAAAAAAAP9tjTEOwjAQBM8BClpKHuFItIiK1krDC0x8GCfWnbEdkooX8TX+gCESFVvtrLSa5wtWKcKBo5UdUu8otU4GP9jS5Mixv3geZcdn2TIl9igbHBs2eJyx4YwwR1SwULBGaj0nRzbDRnX6rmuvydanHMu2V1A5c4MHCFXMWcf8hSnC9jqYxPTz/BXAFEIGsfuclm8zQVqFvQAAAA==[0m[Pipeline] Start of Pipeline
[8mha:////4IwK9WFR2qXaQ7t9BLAtcZkxludFzvCuDQWGM8kdIuXAAAAApR+LCAAAAAAAAP9tjTEOwjAUQ3+KOrAycohUghExsUZZOEFIQkgb/d8mKe3EibgadyBQiQlLlmxL1nu+oE4RjhQdby12HpP2vA+jK4lPFLtroIm3dOGaMFGwXNpJkrGnpUrKFhaxClYC1hZ1oOTRZdiIVt1VExS65pxj2Q4CKm8GeAAThZxVzN8yR9jeRpMIf5y/AJj7DGxXvP/86jduZBmjwAAAAA==[0m[Pipeline] node
Running on [8mha:////4LJacCTMAjfXi9NLPNGumiWd/NgrN7u6eAHOu7Jr0MPtAAAAoR+LCAAAAAAAAP9b85aBtbiIQTGjNKU4P08vOT+vOD8nVc83PyU1x6OyILUoJzMv2y+/JJUBAhiZGBgqihhk0NSjKDWzXb3RdlLBUSYGJk8GtpzUvPSSDB8G5tKinBIGIZ+sxLJE/ZzEvHT94JKizLx0a6BxUmjGOUNodHsLgAz2EgZR/eT83ILSktQifY2k0sycEt3MPE19AHHxbH3KAAAA[0mJenkins in /var/jenkins_home/workspace/pytest
[8mha:////4E/4ImXxpK5Yz5bY1/9wPF0FrAYS2+Cm1bVLtk27IlC8AAAApR+LCAAAAAAAAP9tjTEOwjAUQ3+KOrAycoh0gA0xsUZZOEFIQkgb/d8mKe3EibgadyBQiQlLlmxL1nu+oE4RjhQdby12HpP2vA+jK4lPFLtroIm3dOGaMFGwXNpJkrGnpUrKFhaxClYC1hZ1oOTRZdiIVt1VExS65pxj2Q4CKm8GeAAThZxVzN8yR9jeRpMIf5y/AJj7DGxXvP/86jfoP95RwAAAAA==[0m[Pipeline] {
[8mha:////4LHHqCErv6OCJHY4lNaYR0hP4bqomJFch7FrWZkduEnZAAAApR+LCAAAAAAAAP9tjTEOwjAUQ3+KOrAycoh0gQkxsUZZOEFIQkgb/d8mKe3EibgadyBQiQlLlmxL1nu+oE4RjhQdby12HpP2vA+jK4lPFLtroIm3dOGaMFGwXNpJkrGnpUrKFhaxClYC1hZ1oOTRZdiIVt1VExS65pxj2Q4CKm8GeAAThZxVzN8yR9jeRpMIf5y/AJj7DGxXvP/86jc09154wAAAAA==[0m[Pipeline] stage
[8mha:////4D2LOhS1nNzrQzN5672+DDtoUs6dPxqxZh4fBROHi3YDAAAApR+LCAAAAAAAAP9tjTEOwjAUQ3+KOrAycoh0ggUxsUZZOEFIQkgb/d8mKe3EibgadyBQiQlLlmxL1nu+oE4RjhQdby12HpP2vA+jK4lPFLtroIm3dOGaMFGwXNpJkrGnpUrKFhaxClYC1hZ1oOTRZdiIVt1VExS65pxj2Q4CKm8GeAAThZxVzN8yR9jeRpMIf5y/AJj7DGxXvP/86jek7ggRwAAAAA==[0m[Pipeline] { (Correr el run.sh)
[8mha:////4EmF8LTbWmXeFGlLIarIWIXPTtk2dhFIWFUVbriUFCgRAAAAoh+LCAAAAAAAAP9tjTEOAiEURD9rLGwtPQTbaWGsbAmNJ0AWEZb8zwLrbuWJvJp3kLiJlZNMMm+a93rDOic4UbLcG+wdZu14DKOti0+U+lugiXu6ck2YKRguzSSpM+cFJRUDS1gDKwEbgzpQdmgLbIVXD9UGhba9lFS/o4DGdQM8gYlqLiqVL8wJdvexy4Q/z18BzLEA29ce4gfg7KmOvAAAAA==[0m[Pipeline] sh
+ ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -i /app/docker-key root@pytest cd /app && ./run.sh
Warning: Permanently added 'pytest' (ED25519) to the list of known hosts.
Creating a virtual environment...
Requirement already satisfied: pip in ./.env/lib/python3.9/site-packages (20.3.4)
Collecting pip
  Downloading pip-24.0-py3-none-any.whl (2.1 MB)
Requirement already satisfied: setuptools in ./.env/lib/python3.9/site-packages (44.1.1)
Collecting setuptools
  Downloading setuptools-70.0.0-py3-none-any.whl (863 kB)
Collecting wheel
  Downloading wheel-0.43.0-py3-none-any.whl (65 kB)
Installing collected packages: wheel, setuptools, pip
  Attempting uninstall: setuptools
    Found existing installation: setuptools 44.1.1
    Uninstalling setuptools-44.1.1:
      Successfully uninstalled setuptools-44.1.1
  Attempting uninstall: pip
    Found existing installation: pip 20.3.4
    Uninstalling pip-20.3.4:
      Successfully uninstalled pip-20.3.4
Successfully installed pip-24.0 setuptools-70.0.0 wheel-0.43.0
Collecting allure-pytest==2.13.2 (from -r /app/requirements.txt (line 1))
  Downloading allure_pytest-2.13.2-py3-none-any.whl.metadata (1.8 kB)
Collecting allure-python-commons==2.13.2 (from -r /app/requirements.txt (line 2))
  Downloading allure_python_commons-2.13.2-py3-none-any.whl.metadata (1.1 kB)
Collecting attrs==23.2.0 (from -r /app/requirements.txt (line 3))
  Downloading attrs-23.2.0-py3-none-any.whl.metadata (9.5 kB)
Collecting exceptiongroup==1.2.0 (from -r /app/requirements.txt (line 4))
  Downloading exceptiongroup-1.2.0-py3-none-any.whl.metadata (6.6 kB)
Collecting fastapi==0.68.0 (from -r /app/requirements.txt (line 5))
  Downloading fastapi-0.68.0-py3-none-any.whl.metadata (23 kB)
Collecting flake8==7.0.0 (from -r /app/requirements.txt (line 6))
  Downloading flake8-7.0.0-py2.py3-none-any.whl.metadata (3.8 kB)
Collecting flake8-builtins==2.2.0 (from -r /app/requirements.txt (line 7))
  Downloading flake8_builtins-2.2.0-py3-none-any.whl.metadata (25 kB)
Collecting iniconfig==2.0.0 (from -r /app/requirements.txt (line 8))
  Downloading iniconfig-2.0.0-py3-none-any.whl.metadata (2.6 kB)
Collecting mccabe==0.7.0 (from -r /app/requirements.txt (line 9))
  Downloading mccabe-0.7.0-py2.py3-none-any.whl.metadata (5.0 kB)
Collecting packaging==23.2 (from -r /app/requirements.txt (line 10))
  Downloading packaging-23.2-py3-none-any.whl.metadata (3.2 kB)
Collecting pluggy==1.3.0 (from -r /app/requirements.txt (line 11))
  Downloading pluggy-1.3.0-py3-none-any.whl.metadata (4.3 kB)
Collecting pycodestyle==2.11.1 (from -r /app/requirements.txt (line 12))
  Downloading pycodestyle-2.11.1-py2.py3-none-any.whl.metadata (4.5 kB)
Collecting pyflakes==3.2.0 (from -r /app/requirements.txt (line 13))
  Downloading pyflakes-3.2.0-py2.py3-none-any.whl.metadata (3.5 kB)
Collecting pytest==7.4.4 (from -r /app/requirements.txt (line 14))
  Downloading pytest-7.4.4-py3-none-any.whl.metadata (7.9 kB)
Collecting tomli==2.0.1 (from -r /app/requirements.txt (line 15))
  Downloading tomli-2.0.1-py3-none-any.whl.metadata (8.9 kB)
Collecting requests==2.28.2 (from -r /app/requirements.txt (line 16))
  Downloading requests-2.28.2-py3-none-any.whl.metadata (4.6 kB)
Collecting starlette==0.14.2 (from fastapi==0.68.0->-r /app/requirements.txt (line 5))
  Downloading starlette-0.14.2-py3-none-any.whl.metadata (6.5 kB)
Collecting pydantic!=1.7,!=1.7.1,!=1.7.2,!=1.7.3,!=1.8,!=1.8.1,<2.0.0,>=1.6.2 (from fastapi==0.68.0->-r /app/requirements.txt (line 5))
  Downloading pydantic-1.10.15-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (150 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 150.6/150.6 kB 860.9 kB/s eta 0:00:00
Collecting charset-normalizer<4,>=2 (from requests==2.28.2->-r /app/requirements.txt (line 16))
  Downloading charset_normalizer-3.3.2-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (33 kB)
Collecting idna<4,>=2.5 (from requests==2.28.2->-r /app/requirements.txt (line 16))
  Downloading idna-3.7-py3-none-any.whl.metadata (9.9 kB)
Collecting urllib3<1.27,>=1.21.1 (from requests==2.28.2->-r /app/requirements.txt (line 16))
  Downloading urllib3-1.26.18-py2.py3-none-any.whl.metadata (48 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 48.9/48.9 kB 652.6 kB/s eta 0:00:00
Collecting certifi>=2017.4.17 (from requests==2.28.2->-r /app/requirements.txt (line 16))
  Downloading certifi-2024.2.2-py3-none-any.whl.metadata (2.2 kB)
Collecting typing-extensions>=4.2.0 (from pydantic!=1.7,!=1.7.1,!=1.7.2,!=1.7.3,!=1.8,!=1.8.1,<2.0.0,>=1.6.2->fastapi==0.68.0->-r /app/requirements.txt (line 5))
  Downloading typing_extensions-4.11.0-py3-none-any.whl.metadata (3.0 kB)
Downloading allure_pytest-2.13.2-py3-none-any.whl (10 kB)
Downloading allure_python_commons-2.13.2-py3-none-any.whl (14 kB)
Downloading attrs-23.2.0-py3-none-any.whl (60 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 60.8/60.8 kB 1.0 MB/s eta 0:00:00
Downloading exceptiongroup-1.2.0-py3-none-any.whl (16 kB)
Downloading fastapi-0.68.0-py3-none-any.whl (52 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 52.0/52.0 kB 2.9 MB/s eta 0:00:00
Downloading flake8-7.0.0-py2.py3-none-any.whl (57 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 57.6/57.6 kB 1.0 MB/s eta 0:00:00
Downloading flake8_builtins-2.2.0-py3-none-any.whl (18 kB)
Downloading iniconfig-2.0.0-py3-none-any.whl (5.9 kB)
Downloading mccabe-0.7.0-py2.py3-none-any.whl (7.3 kB)
Downloading packaging-23.2-py3-none-any.whl (53 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 53.0/53.0 kB 1.1 MB/s eta 0:00:00
Downloading pluggy-1.3.0-py3-none-any.whl (18 kB)
Downloading pycodestyle-2.11.1-py2.py3-none-any.whl (31 kB)
Downloading pyflakes-3.2.0-py2.py3-none-any.whl (62 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 62.7/62.7 kB 1.3 MB/s eta 0:00:00
Downloading pytest-7.4.4-py3-none-any.whl (325 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 325.3/325.3 kB 1.4 MB/s eta 0:00:00
Downloading tomli-2.0.1-py3-none-any.whl (12 kB)
Downloading requests-2.28.2-py3-none-any.whl (62 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 62.8/62.8 kB 2.6 MB/s eta 0:00:00
Downloading starlette-0.14.2-py3-none-any.whl (60 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 60.6/60.6 kB 1.1 MB/s eta 0:00:00
Downloading certifi-2024.2.2-py3-none-any.whl (163 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 163.8/163.8 kB 1.6 MB/s eta 0:00:00
Downloading charset_normalizer-3.3.2-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (142 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 142.3/142.3 kB 8.3 MB/s eta 0:00:00
Downloading idna-3.7-py3-none-any.whl (66 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 66.8/66.8 kB 1.1 MB/s eta 0:00:00
Downloading pydantic-1.10.15-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (3.2 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3.2/3.2 MB 1.8 MB/s eta 0:00:00
Downloading urllib3-1.26.18-py2.py3-none-any.whl (143 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 143.8/143.8 kB 1.7 MB/s eta 0:00:00
Downloading typing_extensions-4.11.0-py3-none-any.whl (34 kB)
Installing collected packages: urllib3, typing-extensions, tomli, starlette, pyflakes, pycodestyle, pluggy, packaging, mccabe, iniconfig, idna, exceptiongroup, charset-normalizer, certifi, attrs, requests, pytest, pydantic, flake8, allure-python-commons, flake8-builtins, fastapi, allure-pytest
Successfully installed allure-pytest-2.13.2 allure-python-commons-2.13.2 attrs-23.2.0 certifi-2024.2.2 charset-normalizer-3.3.2 exceptiongroup-1.2.0 fastapi-0.68.0 flake8-7.0.0 flake8-builtins-2.2.0 idna-3.7 iniconfig-2.0.0 mccabe-0.7.0 packaging-23.2 pluggy-1.3.0 pycodestyle-2.11.1 pydantic-1.10.15 pyflakes-3.2.0 pytest-7.4.4 requests-2.28.2 starlette-0.14.2 tomli-2.0.1 typing-extensions-4.11.0 urllib3-1.26.18
Obtaining file:///app
  Installing build dependencies: started
  Installing build dependencies: finished with status 'done'
  Checking if build backend supports build_editable: started
  Checking if build backend supports build_editable: finished with status 'done'
  Getting requirements to build editable: started
  Getting requirements to build editable: finished with status 'done'
  Installing backend dependencies: started
  Installing backend dependencies: finished with status 'done'
  Preparing editable metadata (pyproject.toml): started
  Preparing editable metadata (pyproject.toml): finished with status 'done'
Checking if build backend supports build_editable: started
Checking if build backend supports build_editable: finished with status 'done'
Building wheels for collected packages: pruebas_pytest
  Building editable for pruebas_pytest (pyproject.toml): started
  Building editable for pruebas_pytest (pyproject.toml): finished with status 'done'
  Created wheel for pruebas_pytest: filename=pruebas_pytest-0.0.0-0.editable-py3-none-any.whl size=1426 sha256=4d922aa90671dafd2d821f232451896b76c298e293f33e69496d4e333ed3d88e
  Stored in directory: /tmp/pip-ephem-wheel-cache-iajaajmh/wheels/48/5b/9e/815b53f5a8df8525f516b542a370cd64ff3531d89e06062b64
Successfully built pruebas_pytest
Installing collected packages: pruebas_pytest
Successfully installed pruebas_pytest-0.0.0
============================= test session starts ==============================
platform linux -- Python 3.9.2, pytest-7.4.4, pluggy-1.3.0
rootdir: /app
configfile: pyproject.toml
testpaths: test
plugins: allure-pytest-2.13.2
collected 25 items

test/api-gateway_test.py FF.FFFFFFFF                                     [ 44%]
test/api-healthcheck_test.py ..                                          [ 52%]
test/api-logs_test.py ...FF                                              [ 72%]
test/api-profiles_test.py .                                              [ 76%]
test/api-rest-users_test.py F.FFFF                                       [100%]

=================================== FAILURES ===================================
______________________________ test_salud_gateway ______________________________

    def test_salud_gateway():
        with allure.step("Salud del gateway"):
>           url = f"{url}health-apigateway"
E           UnboundLocalError: local variable 'url' referenced before assignment

test/api-gateway_test.py:19: UnboundLocalError
__________________________________ test_login __________________________________

    def test_login():
        with allure.step("Se loguea con éxito "):
            url = f"{url_base}/login"
            login_data = {
            "email": "andresf.castroc1@uqvirtual.edu.co",
            "password": "andres1234"
            }
            response = requests.post(url, data=json.dumps(login_data), headers={"Content-Type": "application/json"})
>           assert response.status_code == 200
E           assert 404 == 200
E            +  where 404 = <Response [404]>.status_code

test/api-gateway_test.py:31: AssertionError
_____________________________ test_obtener_log_app _____________________________

    def test_obtener_log_app():
        with allure.step("Obtener log por aplicación"):
            urlFinal = f"{url_base}logs/API?from_date=2023-04-16&to_date=2023-12-31&tipo=Login"
            response = requests.get(url_base)
>           assert response.status_code == 200
E           assert 404 == 200
E            +  where 404 = <Response [404]>.status_code

test/api-gateway_test.py:42: AssertionError
________________________________ test_crear_log ________________________________

    def test_crear_log():
        with allure.step("Crear un log"):
            urlFinal = f"{url_base}logs"
            payload = {
                "tipo":"Login",
                "aplicacion":"Api_users",
                "clase_modulo":"auth_controller",
                "resumen":"Se logueo un usuario",
                "descripcion":"Se logueo el usuario con correo test@gmail.com"
            }
            response = requests.post(url_base, data=json.dumps(payload), headers={"Content-Type": "application/json"})
>           assert response.status_code == 200
E           assert 404 == 200
E            +  where 404 = <Response [404]>.status_code

test/api-gateway_test.py:55: AssertionError
_____________________________ test_obtener_usuario _____________________________

    def test_obtener_usuario():
        with allure.step("Se obtiene usuario por id" ):
            url = f"{url_base}/usuarios/36"
    
            bearerToken = login()
    
            headers = {
                "Authorization": f"Bearer {bearerToken}"
            }
    
>           response = requests.get(url, headers=headers)

test/api-gateway_test.py:67: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.env/lib/python3.9/site-packages/requests/api.py:73: in get
    return request("get", url, params=params, **kwargs)
.env/lib/python3.9/site-packages/requests/api.py:59: in request
    return session.request(method=method, url=url, **kwargs)
.env/lib/python3.9/site-packages/requests/sessions.py:573: in request
    prep = self.prepare_request(req)
.env/lib/python3.9/site-packages/requests/sessions.py:484: in prepare_request
    p.prepare(
.env/lib/python3.9/site-packages/requests/models.py:369: in prepare
    self.prepare_headers(headers)
.env/lib/python3.9/site-packages/requests/models.py:491: in prepare_headers
    check_header_validity(header)
.env/lib/python3.9/site-packages/requests/utils.py:1043: in check_header_validity
    _validate_header_part(value, "value", HEADER_VALIDATORS[type(value)][1])
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

header_part = 'Bearer <!DOCTYPE html>\n<html lang="en">\n<head>\n<meta charset="utf-8">\n<title>Error</title>\n</head>\n<body>\n<pre>Cannot POST //login</pre>\n</body>\n</html>\n'
header_kind = 'value', validator = re.compile('^\\S[^\\r\\n]*$|^$')

    def _validate_header_part(header_part, header_kind, validator):
        if not validator.match(header_part):
>           raise InvalidHeader(
                f"Invalid leading whitespace, reserved character(s), or return"
                f"character(s) in header {header_kind}: {header_part!r}"
            )
E           requests.exceptions.InvalidHeader: Invalid leading whitespace, reserved character(s), or returncharacter(s) in header value: 'Bearer <!DOCTYPE html>\n<html lang="en">\n<head>\n<meta charset="utf-8">\n<title>Error</title>\n</head>\n<body>\n<pre>Cannot POST //login</pre>\n</body>\n</html>\n'

.env/lib/python3.9/site-packages/requests/utils.py:1048: InvalidHeader
___________________________ test_actualizar_usuario ____________________________

    def  test_actualizar_usuario():
        with allure.step("Se actualiza el usuario" ):
            url = f"{url_base}/usuarios/1"
            bearerToken = login()
    
            headers = {
                "Authorization": f"Bearer {bearerToken}",
                "Content-Type": "application/json"
            }
    
            payload = {
            "email": "johan@email.com"
            }
    
            response = requests.put(url, data=json.dumps(payload))
>           assert response.status_code == 200
E           assert 404 == 200
E            +  where 404 = <Response [404]>.status_code

test/api-gateway_test.py:85: AssertionError
____________________________ test_registrar_usuario ____________________________

    def test_registrar_usuario():
        with allure.step("Se crea un usuario"):
            url = f"{url_base}/usuarios"
            payload = {
                "id": 0,
                "email": "example@gmail.com",
                "password": "12324124",
                "pagina_personal": "local.org",
                "apodo": "Puto enano",
                "contacto_publico": True,
                "direccion": "maplesoft",
                "biografia": "Hola mundo",
                "organizacion": "no se",
                "pais": "Colombia",
                "redes_soaiales": [{"Instagram": "red"}]
            }
            response = requests.post(url, data=json.dumps(payload), headers={"Content-Type": "application/json"})
>           assert response.status_code == 200
E           assert 404 == 200
E            +  where 404 = <Response [404]>.status_code

test/api-gateway_test.py:104: AssertionError
_____________________________ test_recuperar_clave _____________________________

    def test_recuperar_clave():
        with allure.step("Se recupera la clave" ):
            url = f"{url_base}/usuarios/recuperarContraseña/mabuga23@gmail.com"
            response = requests.post(url)
>           assert response.status_code == 200
E           assert 404 == 200
E            +  where 404 = <Response [404]>.status_code

test/api-gateway_test.py:110: AssertionError
___________________________ test_registrar_servicio ____________________________

    def test_registrar_servicio():
        with allure.step("Se registra un servicio" ):
            payload = {
                "name": "api-logs",
                "endpoint": "http://api_logs:8083/health",
                "frequency": 60,
                "emails": ["mauricio.burgosg@uqvirtual.edu.co"]
            }
            url = f"{url_base}/registrar-service"
            response = requests.post(url, data=json.dumps(payload), headers={"Content-Type": "application/json"})
>           assert response.status_code == 200
E           assert 404 == 200
E            +  where 404 = <Response [404]>.status_code

test/api-gateway_test.py:122: AssertionError
_________________________________ test_health __________________________________

    def test_health():
        with allure.step("Salú" ):
            url = f"{url_base}/health"
            response = requests.post(url)
>           assert response.status_code == 200
E           assert 404 == 200
E            +  where 404 = <Response [404]>.status_code

test/api-gateway_test.py:128: AssertionError
_____________________________ test_obtener_log_app _____________________________

    def test_obtener_log_app():
        with allure.step("Obtener log por aplicación"):
            urlFinal = f"{url}logs/API?from_date=2023-04-16&to_date=2023-12-31&tipo=Login"
            response = requests.get(url)
>           assert response.status_code == 200
E           assert 404 == 200
E            +  where 404 = <Response [404]>.status_code

test/api-logs_test.py:32: AssertionError
________________________________ test_crear_log ________________________________

    def test_crear_log():
        with allure.step("Crear un log"):
            urlFinal = f"{url}logs"
            payload = {
                "tipo":"Login",
                "aplicacion":"Api_users",
                "clase_modulo":"auth_controller",
                "resumen":"Se logueo un usuario",
                "descripcion":"Se logueo el usuario con correo test@gmail.com"
            }
            response = requests.post(url, data=json.dumps(payload), headers={"Content-Type": "application/json"})
>           assert response.status_code == 200
E           assert 404 == 200
E            +  where 404 = <Response [404]>.status_code

test/api-logs_test.py:45: AssertionError
_______________________________ test_login_exito _______________________________

    def test_login_exito():
        with allure.step("Se loguea con éxito "):
            url = f"{url_base}/login"
            login_data = {
            "email": "andresf.castroc1@uqvirtual.edu.co",
            "password": "andres1234"
            }
            response = requests.post(url, data=json.dumps(login_data), headers={"Content-Type": "application/json"})
>           assert response.status_code == 200
E           assert 400 == 200
E            +  where 400 = <Response [400]>.status_code

test/api-rest-users_test.py:25: AssertionError
____________________________ test_registrar_usuario ____________________________

    def test_registrar_usuario():
        with allure.step("Se crea un usuario"):
            url = f"{url_base}/usuarios"
            payload = {
                "id": 0,
                "email": "example@gmail.com",
                "password": "12324124",
                "pagina_personal": "local.org",
                "apodo": "Puto enano",
                "contacto_publico": True,
                "direccion": "maplesoft",
                "biografia": "Hola mundo",
                "organizacion": "no se",
                "pais": "Colombia",
                "redes_soaiales": [{"Instagram": "red"}]
            }
            response = requests.post(url, data=json.dumps(payload), headers={"Content-Type": "application/json"})
>           assert response.status_code == 200
E           assert 500 == 200
E            +  where 500 = <Response [500]>.status_code

test/api-rest-users_test.py:50: AssertionError
_____________________________ test_obtener_usuario _____________________________

    def test_obtener_usuario():
        with allure.step("Se obtiene usuario por id" ):
            url = f"{url_base}/usuarios/36"
    
            bearerToken = login()
    
            headers = {
                "Authorization": f"Bearer {bearerToken}"
            }
    
            response = requests.get(url, headers=headers)
>           assert response.status_code == 200
E           assert 500 == 200
E            +  where 500 = <Response [500]>.status_code

test/api-rest-users_test.py:64: AssertionError
___________________________ test_actualizar_usuario ____________________________

    def  test_actualizar_usuario():
        with allure.step("Se actualiza el usuario" ):
            url = f"{url_base}/usuarios/1"
            bearerToken = login()
    
            headers = {
                "Authorization": f"Bearer {bearerToken}",
                "Content-Type": "application/json"
            }
    
            payload = {
            "email": "johan@email.com"
            }
    
            response = requests.put(url, data=json.dumps(payload))
>           assert response.status_code == 200
E           assert 500 == 200
E            +  where 500 = <Response [500]>.status_code

test/api-rest-users_test.py:92: AssertionError
_____________________________ test_recuperar_clave _____________________________

    def test_recuperar_clave():
        with allure.step("Se recupera la clave" ):
            url = f"{url_base}/usuarios/recuperarContraseña/mabuga23@gmail.com"
            response = requests.post(url)
>           assert response.status_code == 200
E           assert 500 == 200
E            +  where 500 = <Response [500]>.status_code

test/api-rest-users_test.py:99: AssertionError
=========================== short test summary info ============================
FAILED test/api-gateway_test.py::test_salud_gateway - UnboundLocalError: loca...
FAILED test/api-gateway_test.py::test_login - assert 404 == 200
FAILED test/api-gateway_test.py::test_obtener_log_app - assert 404 == 200
FAILED test/api-gateway_test.py::test_crear_log - assert 404 == 200
FAILED test/api-gateway_test.py::test_obtener_usuario - requests.exceptions.I...
FAILED test/api-gateway_test.py::test_actualizar_usuario - assert 404 == 200
FAILED test/api-gateway_test.py::test_registrar_usuario - assert 404 == 200
FAILED test/api-gateway_test.py::test_recuperar_clave - assert 404 == 200
FAILED test/api-gateway_test.py::test_registrar_servicio - assert 404 == 200
FAILED test/api-gateway_test.py::test_health - assert 404 == 200
FAILED test/api-logs_test.py::test_obtener_log_app - assert 404 == 200
FAILED test/api-logs_test.py::test_crear_log - assert 404 == 200
FAILED test/api-rest-users_test.py::test_login_exito - assert 400 == 200
FAILED test/api-rest-users_test.py::test_registrar_usuario - assert 500 == 200
FAILED test/api-rest-users_test.py::test_obtener_usuario - assert 500 == 200
FAILED test/api-rest-users_test.py::test_actualizar_usuario - assert 500 == 200
FAILED test/api-rest-users_test.py::test_recuperar_clave - assert 500 == 200
========================= 17 failed, 8 passed in 1.78s =========================
Generating report to temp directory...
Report successfully generated to /tmp/15727657031267344906/allure-report
Starting web server...
2024-05-23 15:17:52.110:INFO::main: Logging initialized @4948ms to org.eclipse.jetty.util.log.StdErrLog
Can not open browser because this capability is not supported on your platform. You can use the link below to open the report manually.
Server started at <http://172.18.0.3:50390/>. Press <Ctrl+C> to exit
Resuming build at Thu May 23 15:34:54 UTC 2024 after Jenkins restart
Ready to run at Thu May 23 15:34:54 UTC 2024
Resuming build at Thu May 23 15:38:37 UTC 2024 after Jenkins restart
Ready to run at Thu May 23 15:38:37 UTC 2024
Sending interrupt signal to process
Aborted by [8mha:////4Nita3wYCRxduj1G2MT4V8huTc10nMoTGHqAHpi6MgtnAAAAmh+LCAAAAAAAAP9b85aBtbiIQTGjNKU4P08vOT+vOD8nVc83PyU1x6OyILUoJzMv2y+/JJUBAhiZGBgqihhk0NSjKDWzXb3RdlLBUSYGJk8GtpzUvPSSDB8G5tKinBIGIZ+sxLJE/ZzEvHT94JKizLx0a6BxUmjGOUNodHsLgAzhEgY+/dLi1CL9xKLk0ryUzHwAj/Qt9cMAAAA=[0msantiago arciniegas
Aborted by [8mha:////4Nita3wYCRxduj1G2MT4V8huTc10nMoTGHqAHpi6MgtnAAAAmh+LCAAAAAAAAP9b85aBtbiIQTGjNKU4P08vOT+vOD8nVc83PyU1x6OyILUoJzMv2y+/JJUBAhiZGBgqihhk0NSjKDWzXb3RdlLBUSYGJk8GtpzUvPSSDB8G5tKinBIGIZ+sxLJE/ZzEvHT94JKizLx0a6BxUmjGOUNodHsLgAzhEgY+/dLi1CL9xKLk0ryUzHwAj/Qt9cMAAAA=[0msantiago arciniegas
Sending interrupt signal to process
[8mha:////4N0PQyoEZOxErLyqg1ZG9Qu8FwedBg/3IIlM66129EFDAAAA8x+LCAAAAAAAAP9djDFOAzEQRWc3ghpRRnQ0VOOkAJSgVFCAFAFSuMBmMV7vGs9gj0nScAiuAQ0SV8ghuAAddQoaFm0Fv/mvee/1C7ZigDMKBmvtG+tjaZFdMi3hgkJz52iBMTFTEIyiOaL1nASvr2Y35yvWwVnfXJLonY/e++b4+zOHbAq9FJzA7rQuHgvlCm/UTIL15mQZYK9Kt5E8luQjOY1/KkeTl7fJM69zyC9g22lvpOpyD/AEWav3/+mn3f/K0C3LAZbcAgpk+wIHlQiPlXJUFq6iKOPhaDgYqJrmileio6hDJTrc/wAUGzpvDwEAAA==[0mClick here to forcibly terminate running steps
After 20s process did not stop
[8mha:////4IZUw3dkvKC2RW3velk1KolSxhBbeK0D82VFDJEOILndAAAAoh+LCAAAAAAAAP9tjTEOAiEURD9rLGwtPQTbGRNjZUtoPAGyiLDkfxZYdytP5NW8g8RNrJxkknnTvNcb1jnBiZLl3mDvMGvHYxhtXXyi1N8CTdzTlWvCTMFwaSZJnTkvKKkYWMIaWAnYGNSBskNbYCu8eqg2KLTtpaT6HQU0rhvgCUxUc1GpfGFOsLuPXSb8ef4KYI6xADvU7j9Dg2gqvAAAAA==[0m[Pipeline] }
[8mha:////4HdH3aMyXcanSZOqbjBx66kzXLyIaAImi+g+yvSTMbnJAAAAoh+LCAAAAAAAAP9tjTEOAiEURD9rLGwtPQRbWRhjZUtoPAGyiLDkfxZYdytP5NW8g8RNrJxkknnTvNcb1jnBiZLl3mDvMGvHYxhtXXyi1N8CTdzTlWvCTMFwaSZJnTkvKKkYWMIaWAnYGNSBskNbYCu8eqg2KLTtpaT6HQU0rhvgCUxUc1GpfGFOsLuPXSb8ef4KYI6xADvU7j9J+wGOvAAAAA==[0m[Pipeline] // stage
[8mha:////4DxG6BUqHmT6R+MKETBzZHqVgcfjqvD/4QShaFissF0xAAAAox+LCAAAAAAAAP9tjTEOwjAQBDdBFLSUPMIBiQ5R0VppeIFJjHFi3QX7QlLxIr7GH4iIRMVWO9PM641lijhydKqx1HpKlVdd6N301MCxvQYeVMMXVTElDlaVdii5tqcZSxaLeVmOhcbKUhU4eXKCtW7MwxTBkCvOEid30Mh9fccTmZ7KYqJ8YYzY3Po6Mf06fwMYu06Q77aCbP8BhStF0r0AAAA=[0m[Pipeline] }
[8mha:////4HZGoPxOjO0U7SwXVlQtjMm21Zh8/or/pt0tP6TF72WzAAAAoh+LCAAAAAAAAP9tjbEOgjAURS8YB1dHP6KEOBon14bFL6hQa6F5D9uHMPlF/pr/IJHEyTvdc5bzemOdIo4cnWotdZ5S7VUfBjc/NXLsroFH1fJF1UyJg1WVHStu7GnBisViWZZjpbGxVAdOnpxgq1vzMEUw5IqzxNkdNHLf3PFEpueymChfmCJ2t6FJTL/O3wCmvhfkZSnI9h+Wl0FxvQAAAA==[0m[Pipeline] // node
[8mha:////4C5Amv0uPQ96zWvYzxUrBoZTSgb4AfvAeDMBzAEBy6HjAAAAoh+LCAAAAAAAAP9tjTESgjAQRT84FraWHiKMtI6VbYbGE0SIMZDZxWQRKk/k1byDjMxY+av/XvNeb6xTxJGjU62lzlOqverD4OanRo7dNfCoWr6omilxsKqyY8WNPS1YsVgsy3KsNDaW6sDJkxNsdWsepgiGXHGWOLuDRu6bO57I9FwWE+ULU8TuNjSJ6df5G8DU94J8Xwqy8gPQ3eZBvQAAAA==[0m[Pipeline] End of Pipeline
org.jenkinsci.plugins.workflow.actions.ErrorAction$ErrorId: decf9a93-71f9-49fb-92b1-7eef6ece6079
Finished: ABORTED
